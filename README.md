# متجر قطع الغيار (PHP + SQLite / MySQL)

نسخة محسّنة لنظام **مخزون + فواتير + حركة مخزون (Audit) + صلاحيات**.

## التشغيل (محلياً)

1) تأكد أن PHP 8+ موجود
2) شغّل السيرفر المدمج من داخل مجلد المشروع:

```bash
php -S 127.0.0.1:8000
```

3) افتح مرة واحدة (اختياري) لتجهيز قاعدة البيانات وإنشاء admin:

- `http://127.0.0.1:8000/init_db.php`

4) سجّل الدخول:

- `http://127.0.0.1:8000/login.php`

## بيانات دخول افتراضية
- username: `admin`
- password: `admin123`

## أهم الميزات
- هوية بصرية عربية (خط Cairo) + واجهة محسّنة
- عرض أسعار المنتجات في صفحة المخزن
- **بحث واحد** بالاسم أو رقم القطعة
- **حد تنبيه** لكل قطعة (min_qty) + إبراز الأصناف المنخفضة
- نظام **فواتير**: كل صنف سطر واحد مع كمية (Qty) + طباعة
- صفحة **إدارة الفواتير** (بحث/تصفية/إلغاء مع إرجاع المخزون)
- صفحة **حركة المخزون** (إضافة/صرف/مرتجع) مع سجل Audit
- **صلاحيات المستخدمين**: مدير / كاشير / مخزن + صفحة إدارة مستخدمين
- وضع مظلم (Dark Mode)

## الصفحات
- `index.php` لوحة التحكم
- `products.php` المخزن
- `product_form.php` إضافة/تعديل
- `sales.php` فاتورة جديدة
- `invoices.php` إدارة الفواتير
- `invoice_print.php` طباعة فاتورة
- `movements.php` حركة المخزون + سجل Audit
- `reports.php` التقارير (للمدير)
- `users.php` إدارة المستخدمين (للمدير)

> قاعدة البيانات SQLite موجودة في `data/store.db`


---

## MySQL (اختياري)

يمكنك تشغيل النظام على **MySQL** (مناسب للتشغيل على سيرفر/شبكة داخل السوق).

1) أنشئ قاعدة بيانات (مثال: `parts_store`)
2) افتح ملف `config.php` وعدّل:

- `DB_DRIVER` إلى `mysql`
- `MYSQL_HOST`, `MYSQL_PORT`, `MYSQL_DB`, `MYSQL_USER`, `MYSQL_PASS`

3) بعد تشغيل المشروع افتح مرة واحدة:

- `init_db.php`

سيتم إنشاء الجداول تلقائياً (Auto Migration) وإنشاء مستخدم `admin` إن لم يوجد مستخدمين.

---

## تحويل المشروع إلى EXE ثم Installer عبر Inno Setup (Windows)

> ملاحظة: هذا المشروع PHP Web. لتحويله إلى برنامج EXE على ويندوز ستحتاج Wrapper يقوم بتشغيل PHP + WebView محلياً.

### خيار عملي: PHPDesktop

1) حمّل PHPDesktop (Windows)  
2) ضع ملفات المشروع داخل مجلد `www` الخاص بـ PHPDesktop  
3) عدّل `settings.json` لتحديد الصفحة الرئيسية (عادة `login.php` أو `index.php`)  
4) شغّل `phpdesktop.exe` وستجد البرنامج يعمل كـ EXE

### إنشاء Setup عبر Inno Setup

- ستجد ملف قالب جاهز داخل: `build/inno_setup_template.iss`
- افتح Inno Setup ثم اختر الملف وعدّل:
  - اسم البرنامج
  - مسار ملفات الـ EXE الناتجة من PHPDesktop
  - رقم الإصدار

ثم Build لإخراج ملف Setup.

